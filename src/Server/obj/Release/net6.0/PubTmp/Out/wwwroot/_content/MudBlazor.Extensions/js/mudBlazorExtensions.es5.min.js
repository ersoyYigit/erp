"use strict";function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),MudBlazorExtensionHelper=function(){function n(t,i,r){_classCallCheck(this,n);this.dotnet=i;this.onDone=r;this.options=t;this.mudDialogSelector=t.mudDialogSelector||".mud-dialog:not([data-mud-extended=true])";this.mudDialogHeaderSelector=t.mudDialogHeaderSelector||".mud-dialog-title";this.dialog=document.querySelector(this.mudDialogSelector);this.dialogHeader=this.dialog.querySelector(this.mudDialogHeaderSelector)}return _createClass(n,[{key:"findDialog",value:function(){return Array.from(document.querySelectorAll(this.mudDialogSelector)).filter(function(n){return!n.__extended})[0]}},{key:"init",value:function(){var n=this;this.dialog=this.dialog||this.findDialog();this.dialog?this.handleExtensions():(this.observer=new MutationObserver(function(t){var i=t.filter(function(t){return t.addedNodes&&t.addedNodes[0]===n.findDialog()});i.length&&(n.dialog=i[0].addedNodes[0],n.observer.disconnect(),n.handleExtensions())}),this.observer.observe(document,{characterData:!0,childList:!0,subtree:!0}))}},{key:"handleExtensions",value:function(){var t=this,r,i,n;this.dialog.__extended=!0;this.dialog.setAttribute("data-mud-extended",!0);this.options.showAtCursor&&this.moveElementToMousePosition(this.dialog);setTimeout(function(){return t.dialog.classList.remove("mud-ex-dialog-initial")},50);this.options.animations!=null&&Array.isArray(this.options.animations)&&this.options.animations.length&&this.animate(this.options.animationDescriptions);this.options.disablePositionMargin&&this.dialog.classList.add("mud-dialog-position-fixed");this.options.fullHeight&&(r=this.options.disableSizeMarginY?"mud-dialog-height-full-no-margin":"mud-dialog-height-full",this.dialog.classList.add(r),i=this.dialog.querySelector(".mud-dialog-actions"),i&&i.classList.add("mud-dialog-actions-fixed-bottom"));this.options.fullWidth&&this.options.disableSizeMarginX&&(this.dialog.classList.remove("mud-dialog-width-full"),this.dialog.classList.add("mud-dialog-width-full-no-margin"),this.dialog.classList.contains("mud-dialog-width-false")&&this.dialog.classList.remove("mud-dialog-width-false"));this.options.buttons&&this.options.buttons.length&&(n=document.createElement("div"),n.classList.add("mud-ex-dialog-header-actions"),this.options.closeButton||(n.style.right="8px"),this.dialogHeader&&(n=this.dialogHeader.insertAdjacentElement("beforeend",n)),this.options.buttons.reverse().forEach(function(i){if(n){n.insertAdjacentHTML("beforeend",i.html);var r=n.querySelector("#"+i.id);r.onclick=function(){i.id.indexOf("mud-button-maximize")>=0&&t.maximize();i.id.indexOf("mud-button-minimize")>=0?t.minimize():i.callBackReference.invokeMethodAsync(i.callbackName)}}}));this.options.modal===!1&&(this.dialog.parentElement.querySelector(".mud-overlay").style.display="none",setTimeout(function(){t.makeDialogAbsolute();t.dialog.parentElement.style.height="0"},this.options.animationDurationInMs+50));this.options.dragMode!==0&&this.dialog&&(this.dragElement(this.dialog,this.dialogHeader,document.body,this.options.dragMode===2),this.done());this.checkResizeable()}},{key:"minimize",value:function(){var n=document.querySelector(".mud-ex-task-bar-item-for-"+this.dialog.id);this.moveToElement(n)}},{key:"moveToElement",value:function(n){var t=n.getBoundingClientRect();this.dialog.style.height=n.style.height;this.dialog.style.width=n.style.width;this.dialog.style.left=t.left+"px";this.dialog.style.top=t.top+"px"}},{key:"makeDialogAbsolute",value:function(){this.dialog.style.position="absolute";var n=this.dialog.getBoundingClientRect();this.dialog.style.left=n.left+"px";this.dialog.style.top=n.top+"px"}},{key:"moveElementToMousePosition",value:function(n){var u=MudBlazorExtensions.getCurrentMousePosition(),i=u.clientX,r=u.clientY,t=this.options.cursorPositionOriginName.split("-"),f=this.options.maxWidth===6||this.options.maxWidth===4;this.options.fullWidth&&f||(t[1]==="left"?n.style.left=i+"px":t[1]==="right"?n.style.left=i-n.offsetWidth+"px":t[1]==="center"&&(n.style.left=i-n.offsetWidth/2+"px"));this.options.fullHeight||(t[0]==="top"?n.style.top=r+"px":t[0]==="bottom"?n.style.top=r-n.offsetHeight+"px":t[0]==="center"&&(n.style.top=r-n.offsetHeight/2+"px"));this.ensureElementIsInScreenBounds(n)}},{key:"ensureElementIsInScreenBounds",value:function(n){var r=this,t=n.getBoundingClientRect(),f=t.width===0&&t.height===0,i,u;if(f&&(i=function(){var t=new ResizeObserver(function(){t.disconnect();r.ensureElementIsInScreenBounds(n)});return t.observe(n),{v:undefined}}(),typeof i=="object"))return i.v;if(u=!!n.getAnimations().length,u){n.addEventListener("animationend",function(){return r.ensureElementIsInScreenBounds(n)},{once:!0});return}t.left<0&&(n.style.left="0px");t.top<0&&(n.style.top="0px");t.right>window.innerWidth&&(n.style.left=window.innerWidth-n.offsetWidth+"px");t.bottom>window.innerHeight&&(n.style.top=window.innerHeight-n.offsetHeight+"px")}},{key:"checkResizeable",value:function(){this.dialog.style.position="absolute";this.options.resizeable&&(this.dialog.style.resize="both",this.dialog.style.overflow="auto",this.dialog.style.maxWidth=window.innerWidth+"px",this.dialog.style.maxHeight=window.innerHeight+"px",this.dialog.style.minWidth="100px",this.dialog.style.minHeight="100px")}},{key:"maximize",value:function(){this._oldStyle?(this.dialog.style=this._oldStyle,delete this._oldStyle):(this._oldStyle=this.dialog.style,this.dialog.style.position="absolute",this.dialog.style.left="0",this.dialog.style.top="0",this.dialog.style.maxWidth=this.dialog.style.width=window.innerWidth+"px",this.dialog.style.maxHeight=this.dialog.style.height=window.innerHeight+"px");this.checkResizeable()}},{key:"done",value:function(){this.observer&&this.observer.disconnect();this.onDone&&this.onDone()}},{key:"dragElement",value:function(n,t,i,r){function s(n){n=n||window.event;n.preventDefault();u=n.clientX;f=n.clientY;document.onmouseup=c;document.onmousemove=h}function h(t){t=t||window.event;t.preventDefault();e=u-t.clientX;o=f-t.clientY;u=t.clientX;f=t.clientY;var c={x:i.offsetWidth-n.offsetWidth,y:(i===document.body?window.innerHeight:i.offsetHeight)-n.offsetHeight},s=n.offsetTop-o,h=n.offsetLeft-e;n.style.position="absolute";(r||h>0&&h<c.x)&&(n.style.left=h+"px");(r||s>0&&s<c.y)&&(n.style.top=s+"px");e=u-t.clientX;o=f-t.clientY;u=t.clientX;f=t.clientY}function c(){document.onmouseup=null;document.onmousemove=null}var e=0,o=0,u=0,f=0;i=i||document.body;t?(t.style.cursor="move",t.onmousedown=s):n.onmousedown=s}},{key:"animate",value:function(){this.dialog.style.animation=""+this.options.animationStyle}}]),n}();window.MudBlazorExtensionHelper=MudBlazorExtensionHelper;window.MudBlazorExtensions={helper:null,currentMouseArgs:null,__bindEvents:function(){var n=function(n){window.MudBlazorExtensions.currentMouseArgs=n};document.addEventListener("mousemove",n,!1);document.addEventListener("mouseenter",n,!1)},getCurrentMousePosition:function(){return window.MudBlazorExtensions.currentMouseArgs},setNextDialogOptions:function(n,t){new MudBlazorExtensionHelper(n,t,function(){MudBlazorExtensions.helper=null;delete MudBlazorExtensions.helper}).init()},addCss:function(n){var i=n,r=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");r.appendChild(t);t.type="text/css";t.styleSheet?t.styleSheet.cssText=i:t.appendChild(document.createTextNode(i))},downloadFile:function(n){var t=n.url||"data:"+n.mimeType+";base64,"+n.base64String;fetch(t).then(function(n){return n.blob()}).then(function(t){var i=window.document.createElement("a");i.href=window.URL.createObjectURL(t);i.download=n.fileName;document.body.appendChild(i);i.click();document.body.removeChild(i)})},attachDialog:function(n){var i;if(n&&(i=document.getElementById(n),i)){var t=i.querySelector(".mud-dialog-title"),r=t?t.querySelector("svg"):null;return{title:t?t.innerText:"Unnamed window",icon:r?r.innerHTML:""}}return null}};window.MudBlazorExtensions.__bindEvents();